<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>imgAreaSelect</title>
		<style></style>
	<link rel="stylesheet" type="text/css" href="./files/imgareaselect-anima.css">
	<link rel="stylesheet" type="text/css" href="./files/imgareaselect-animated.css">
	<script type="text/javascript" src="./files/jquery-1.8.3.min.js"></script>
	<script type="text/javascript" src="./files/jquery.imgareaselect.pack.js"></script>
	<script type="text/javascript">
		function test(){
			alert($("#upload").val());
			$('#preview img').css({
				src : $("#upload").val()				
			});
		}
	</script>
	</head>
	<body>
		<div class="frame" style="width: 300px; height: 300px;float:left;margin-right:50px">
			<img id="photo" src="http://sandbox.runjs.cn/uploads/rs/351/8eazlvc1/flower2.jpg">
		</div>
		<div id="preview" style="width: 100px; height: 100px; overflow: hidden;">
			<img id="adImage" src="./files/flower2.jpg" style="width: 100px; height: 100px;">
		</div>
		<div>
		<input type="file" name="upload" value="" id="upload" />
		<input type="button" name="aaa" value="" id="aaa" value="test" onclick="test()" />
		</div>
		<br/><br/>
		<form action="youraction" method="post">
			x :<input id="startX" name="startX" readonly="readonly"/>
			y :<input id="startY" name="startY" readonly="readonly"/><br/>
			宽:<input id="width" name="width" readonly="readonly"/>
			高:<input id="height" name="height" readonly="readonly"/><br/>			 
		</form>
		<script type="text/javascript">
			function preview(img, selection) {
				if (!selection.width || !selection.height)
					return;
				var scaleX = 100 / selection.width;
				var scaleY = 100 / selection.height;

				$('#preview img').css({
					width : Math.round(scaleX * 300),
					height : Math.round(scaleY * 300),
					marginLeft : -Math.round(scaleX * selection.x1),
					marginTop : -Math.round(scaleY * selection.y1)
				});
				
				$("#startX").val(selection.x1);
				$("#startY").val(selection.y1);
				$("#width").val(selection.width);
				$("#height").val(selection.height);
			}
			
			$(function() {
				$('#photo').imgAreaSelect({
					aspectRatio : '1:1',
					handles : true,
					fadeSpeed : 200,
					onSelectChange : preview
				});
			});
		</script>
	</body>
</html>